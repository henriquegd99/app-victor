
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>App Personal Victor</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f2f2f2;
      padding: 20px;
    }
    .container {
      background: white;
      padding: 20px;
      margin: 20px auto;
      border-radius: 10px;
      max-width: 800px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, textarea, select, button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container" id="login">
    <h2>Login</h2>
    <input type="email" id="loginEmail" placeholder="Email" />
    <input type="password" id="loginSenha" placeholder="Senha" />
    <button onclick="login()">Entrar</button>
  </div>

  <div class="container hidden" id="dashboardVictor">
    <h2>Bem-vindo, Victor!</h2>
    <button onclick="mostrarCadastroAluno()">Cadastrar Aluno</button>
    <button onclick="mostrarGerenciarTreinos()">Gerenciar Treinos</button>
    <button onclick="mostrarListaAlunos()">Lista de Alunos</button>
    <button onclick="logout()">Sair</button>
  </div>

  <div class="container hidden" id="cadastroAluno">
    <h3>Cadastrar Novo Aluno</h3>
    <input type="text" id="alunoNome" placeholder="Nome do Aluno" />
    <input type="email" id="alunoEmail" placeholder="Email do Aluno" />
    <input type="password" id="alunoSenha" placeholder="Senha Padrão" value="123456" />
    <button onclick="cadastrarAluno()">Cadastrar</button>
    <button onclick="voltarDashboard()">Voltar</button>
  </div>

  <div class="container hidden" id="gerenciarTreinos">
    <h3>Gerenciar Treinos</h3>
    <select id="alunoSelecionado"></select>
    <textarea id="treinoTexto" placeholder="Ex: Peito - 4x12 / Bíceps - 3x10"></textarea>
    <button onclick="salvarTreino()">Salvar Treino</button>
    <button onclick="voltarDashboard()">Voltar</button>
  </div>

  <div class="container hidden" id="listaAlunos">
    <h3>Alunos Cadastrados</h3>
    <ul id="alunosList"></ul>
    <button onclick="voltarDashboard()">Voltar</button>
  </div>

  <div class="container hidden" id="dashboardAluno">
    <h2>Seus Treinos</h2>
    <div id="meusTreinos"></div>
    <label>Nova senha:</label>
    <input type="password" id="novaSenhaAlunoUsuario" />
    <button onclick="alterarSenhaAluno()">Alterar Senha</button>
    <button onclick="logout()">Sair</button>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCUzsO0GCYCVtcy161JYl7OFQ3vEA9WcD8",
      authDomain: "app-personal-victor.firebaseapp.com",
      projectId: "app-personal-victor",
      storageBucket: "app-personal-victor.appspot.com",
      messagingSenderId: "148264648190",
      appId: "1:148264648190:web:44ca5e2d571a5d00acd4af"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    function login() {
      const email = document.getElementById("loginEmail").value;
      const senha = document.getElementById("loginSenha").value;
      auth.signInWithEmailAndPassword(email, senha)
        .then((cred) => {
          const usuario = cred.user.email;
          if (usuario === "victor@personal.com") {
            mostrar("dashboardVictor");
            carregarAlunos();
          } else {
            mostrar("dashboardAluno");
            carregarTreinosAluno(usuario);
          }
        })
        .catch(err => alert("Erro: " + err.message));
    }

    function mostrar(id) {
      ["login", "dashboardVictor", "cadastroAluno", "gerenciarTreinos", "listaAlunos", "dashboardAluno"]
        .forEach(el => document.getElementById(el).classList.add("hidden"));
      document.getElementById(id).classList.remove("hidden");
    }

    function logout() {
      auth.signOut().then(() => mostrar("login"));
    }

    function mostrarCadastroAluno() {
      mostrar("cadastroAluno");
    }

    function mostrarGerenciarTreinos() {
      carregarAlunosNoSelect();
      mostrar("gerenciarTreinos");
    }

    function mostrarListaAlunos() {
      mostrar("listaAlunos");
      carregarLista();
    }

    function voltarDashboard() {
      mostrar("dashboardVictor");
    }

    function cadastrarAluno() {
      const nome = document.getElementById("alunoNome").value;
      const email = document.getElementById("alunoEmail").value;
      const senha = document.getElementById("alunoSenha").value;

      auth.createUserWithEmailAndPassword(email, senha)
        .then(() => db.collection("alunos").doc(email).set({ nome, email, treinos: "" }))
        .then(() => alert("Aluno cadastrado com sucesso!"))
        .catch(err => alert("Erro: " + err.message));
    }

    function carregarAlunos() {
      db.collection("alunos").get().then(snapshot => {
        const lista = document.getElementById("alunosList");
        lista.innerHTML = "";
        snapshot.forEach(doc => {
          const aluno = doc.data();
          const li = document.createElement("li");
          li.textContent = aluno.nome + " - " + aluno.email;
          lista.appendChild(li);
        });
      });
    }

    function carregarAlunosNoSelect() {
      const select = document.getElementById("alunoSelecionado");
      select.innerHTML = "";
      db.collection("alunos").get().then(snapshot => {
        snapshot.forEach(doc => {
          const aluno = doc.data();
          const option = document.createElement("option");
          option.value = aluno.email;
          option.textContent = aluno.nome;
          select.appendChild(option);
        });
      });
    }

    function salvarTreino() {
      const email = document.getElementById("alunoSelecionado").value;
      const treino = document.getElementById("treinoTexto").value;
      db.collection("alunos").doc(email).update({ treinos: treino })
        .then(() => alert("Treino salvo!"));
    }

    function carregarTreinosAluno(email) {
      db.collection("alunos").doc(email).get().then(doc => {
        if (doc.exists) {
          document.getElementById("meusTreinos").innerText = doc.data().treinos || "Sem treinos cadastrados ainda.";
        }
      });
    }

    function alterarSenhaAluno() {
      const novaSenha = document.getElementById("novaSenhaAlunoUsuario").value;
      auth.currentUser.updatePassword(novaSenha)
        .then(() => alert("Senha alterada com sucesso!"))
        .catch(err => alert("Erro: " + err.message));
    }
  </script>
</body>
</html>
